const API_KEY="AIzaSyDMbhCmhzrIsKXoGrxbqOTRzdoYiwxllag",CLIENT_ID="4137827372-07nd717u8ecpq74eetr5l2sidd3649nv.apps.googleusercontent.com",DISCOVERY_DOCS=["https://sheets.googleapis.com/$discovery/rest?version=v4"],SCOPES="https://www.googleapis.com/auth/spreadsheets",firebaseConfig={apiKey:"AIzaSyDMbhCmhzrIsKXoGrxbqOTRzdoYiwxllag",authDomain:"tape-deck-static.firebaseapp.com",databaseURL:"https://tape-deck-static.firebaseio.com",projectId:"tape-deck-static",storageBucket:"",messagingSenderId:"4137827372",appId:"1:4137827372:web:d10f937295dd3a4a506589"};firebase.initializeApp(firebaseConfig);const db=firebase.firestore();let googleUser,isSignedIn;const provider=new firebase.auth.GoogleAuthProvider;provider.addScope(SCOPES);const handleClientLoad=()=>{gapi.load("client:auth2",initClient)},initClient=()=>{gapi.client.init({apiKey:API_KEY,clientId:CLIENT_ID,discoveryDocs:DISCOVERY_DOCS,scope:SCOPES}).then(()=>{if(googleUser=gapi.auth2.getAuthInstance().currentUser.get(),isSignedIn=gapi.auth2.getAuthInstance().isSignedIn.get()){const e=googleUser.getAuthResponse().id_token,t=firebase.auth.GoogleAuthProvider.credential(e);firebase.auth().signInWithCredential(t).then(e=>{googleUser.getBasicProfile();e&&listMajors()})}})},loading=document.getElementsByClassName("bouncybox")[0],loginWindow=document.getElementById("login_window"),userContent=document.getElementById("user_content");document.getElementById("sign_in_btn").addEventListener("click",()=>{firebase.auth().signInWithPopup(provider).then(function(e){e.credential.accessToken,e.user}).catch(function(e){e.code,e.message,e.email,e.credential})}),document.getElementById("sign_out_btn").addEventListener("click",()=>{console.log("Log out"),firebase.auth().signOut().then(function(){}).catch(function(e){})}),firebase.auth().onAuthStateChanged(function(e){if(e){verifyUser(e);e.displayName,e.email,e.emailVerified,e.photoURL,e.isAnonymous,e.uid,e.providerData;loading.style.display="none",loginWindow.style.display="none",userContent.style.display="block"}else loading.style.display="none",userContent.style.display="none",loginWindow.style.display="block"});const verifyUser=e=>{db.collection("users").doc(e.uid).set({email:e.email}).then(function(e){console.log("Document written with ID:")}).catch(function(e){console.error("Error adding document: ",e)})},randomGreeting=()=>{const e=document.getElementById("login_title"),t=["Ahoi","Hello","Yo","Hi","Bonjour","Hola","Guten tag","Ciao","Ola","Salaam","Zdrasvuyte","Konban wa","Halo"],n=t.length,s=Math.floor(Math.random()*(+n-0))+0;e.innerText=t[s]+","},getCookie=e=>{const t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()},onLoaded=document.getElementById("onLoaded"),authorizeButton=document.getElementById("sign_in_btn"),signedData=document.getElementById("signedData"),menuBtn=document.getElementById("menu"),header=document.getElementById("fixed_header_area"),isLoggedIn=document.getElementsByClassName("isLoggedIn")[0],isLoggedOut=document.getElementsByClassName("isLoggedOut")[0],appendPre=(e,t)=>{const n=document.getElementById("results_section").insertRow(-1).insertCell(-1);n.className="result_object",n.innerHTML=e,n.addEventListener("focusin",e=>{canUpdate=!1,document.getElementById("disable_updates").style.display="block"}),n.addEventListener("focusout",e=>{canUpdate=!0,document.getElementById("disable_updates").style.display="none"})},listMajors=()=>{let e=[];document.getElementById("results_section");gapi.client.sheets.spreadsheets.values.get({spreadsheetId:"1Ak_zvY5HqoeODZJO7goJBVDxU4uFkHeS6NKsYmuztk8",range:"sheet1"}).then(function(t){const n=t.result;if(n.values&&n.values.length>0)for(i=1;i<n.values.length;i++){const t=n.values[i];t.length&&!e.includes(t[0])&&(appendPre('<input class="update_date" value="'+t[4]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="company_name" value="'+t[0]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="domain_name" value="'+t[1]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="contact_email" value="'+t[2]+'" OnChange="updateRow(this.parentElement,'+i+')"><br><input class="current_state '+(t[3].length?t[3].toLowerCase().replace(/ /g,"_"):"Undefined")+'" value="'+t[3]+'" OnChange="updateRow(this.parentElement,'+i+')">',i),e.push(t[0]))}else appendPre("No results...")},function(e){gapi.auth2.getAuthInstance().signIn(),appendPre("Error: "+e.result.error.message)})},searchFunction=()=>{let e,t,n,s,a,o,i;for(t=(e=document.getElementById("search")).value.toUpperCase(),s=(n=document.getElementById("results_section")).getElementsByTagName("tr"),o=0;o<s.length;o++)(a=s[o].getElementsByTagName("td")[0])&&((i=a.childNodes[1].value).toUpperCase().indexOf(t)>-1?s[o].style.display="":s[o].style.display="none")},toggleMenu=()=>{const e=document.getElementById("fixed_header_area");e.style.display="none"==e.style.display?"block":"none",randomGreeting()},toggleAddForm=e=>{const t=document.getElementById(e);t.style.display="block"==t.style.display?"none":"block"},onAddSubmit=e=>{e.preventDefault();const t=document.getElementById("company").value,n=document.getElementById("domain").value,s=document.getElementById("email").value,a=document.getElementById("status").value;writeRow([t,n,s,a,"=Now()"])},onEditSubmit=e=>{e.preventDefault();const t=document.getElementById("current_sheet_display").value;document.cookie=`sheetID=${t}`},writeRow=e=>{const t={values:[e]};gapi.client.sheets.spreadsheets.values.append({spreadsheetId:"1Ak_zvY5HqoeODZJO7goJBVDxU4uFkHeS6NKsYmuztk8",range:"A1:E",valueInputOption:"USER_ENTERED",resource:t}).then(e=>{location.reload()})},updateRow=(e,t)=>{e=[e.childNodes[1].value,e.childNodes[2].value,e.childNodes[3].value,e.childNodes[5].value,e.childNodes[0].value];const n="A"+(parseInt(t)+1)+":E"+(parseInt(t)+1),s={values:[e]};gapi.client.sheets.spreadsheets.values.update({spreadsheetId:"1Ak_zvY5HqoeODZJO7goJBVDxU4uFkHeS6NKsYmuztk8",range:n,valueInputOption:"USER_ENTERED",resource:s}).then(e=>{e.result;listMajors()})},sortTable=(e,t)=>{let n,s,a,o,i,l=["date","name","domain","email","skip","status"].indexOf(e);for(t=t.toUpperCase(),s=(n=document.getElementById("results_section")).getElementsByTagName("tr"),o=0;o<s.length;o++)(a=s[o].getElementsByTagName("td")[0])&&((i=a.childNodes[l].value).toUpperCase().indexOf(t)>-1?s[o].style.display="":s[o].style.display="none")};
