"use strict";function randomGreeting(){var e=document.getElementById("login_title"),t=["Ahoi","Hello","Yo","Hi","Bonjour","Hola","Guten tag","Ciao","Ola","Salaam","Zdrasvuyte","Konban wa","Halo"],n=t.length,a=Math.floor(Math.random()*(+n-0))+0;e.innerText=t[a]+","}randomGreeting();var CLIENT_ID="929069745301-7c7p3kv04nnqlck4iommqbd94op1irkq.apps.googleusercontent.com",API_KEY="AIzaSyCYjjoLglFHnxywR6QxPs7IDJQFfKFp0Xs",DISCOVERY_DOCS=["https://sheets.googleapis.com/$discovery/rest?version=v4"],SCOPES="https://www.googleapis.com/auth/spreadsheets",onLoaded=document.getElementById("onLoaded"),progress=document.getElementsByClassName("bouncybox")[0],authorizeButton=document.getElementById("sign_in_btn"),signoutButton=document.getElementById("sign_out_btn"),signedData=document.getElementById("signedData"),menuBtn=document.getElementById("menu"),header=document.getElementById("fixed_header_area"),isLoggedIn=document.getElementsByClassName("isLoggedIn")[0],isLoggedOut=document.getElementsByClassName("isLoggedOut")[0];function handleClientLoad(){gapi.load("client:auth2",initClient)}function initClient(){gapi.client.init({apiKey:API_KEY,clientId:CLIENT_ID,discoveryDocs:DISCOVERY_DOCS,scope:SCOPES}).then(function(){gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus),onLoaded.style.display="block",progress.style.display="none",updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get()),authorizeButton.onclick=handleAuthClick,signoutButton.onclick=handleSignoutClick},function(e){console.log(e),appendPre(JSON.stringify(e,null,2))})}var lastRow,canUpdate=!0;function updateSigninStatus(e){e?(authorizeButton.style.display="none",header.style.display="none",isLoggedIn.style.display="block",isLoggedOut.style.display="none",signoutButton.style.display="block",menuBtn.style.display="block",signedData.style.display="block",listMajors(),window.setInterval(function(){canUpdate&&listMajors()},6e4)):(authorizeButton.style.display="block",header.style.display="block",isLoggedIn.style.display="none",isLoggedOut.style.display="block",signoutButton.style.display="none",menuBtn.style.display="none",signedData.style.display="none")}function handleAuthClick(e){gapi.auth2.getAuthInstance().signIn()}function handleSignoutClick(e){gapi.auth2.getAuthInstance().signOut()}function appendPre(e,t){var n=document.getElementById("results_section").insertRow(-1).insertCell(-1);n.className="result_object",n.innerHTML=e,n.addEventListener("focusin",function(e){canUpdate=!1,document.getElementById("disable_updates").style.display="block"}),n.addEventListener("focusout",function(e){canUpdate=!0,document.getElementById("disable_updates").style.display="none"})}var companyList=[];function listMajors(){document.getElementById("results_section");gapi.client.sheets.spreadsheets.values.get({spreadsheetId:"15As92qSD9_6DEZC2nSdPtCqOSLFR4_KNiXWHC0JLY_E",range:"Sheet1"}).then(function(e){var t=e.result;if(t.values&&t.values.length>0)for(i=0;i<t.values.length;i++){var n=t.values[i];n.length&&!companyList.includes(n[0])&&(appendPre('<input class="update_date" value="'+n[4]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="company_name" value="'+n[0]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="domain_name" value="'+n[1]+'" OnChange="updateRow(this.parentElement,'+i+')"><input class="contact_email" value="'+n[2]+'" OnChange="updateRow(this.parentElement,'+i+')"><br><input class="current_state '+(n[3].length?n[3].toLowerCase().replace(/ /g,"_"):"Undefined")+'" value="'+n[3]+'" OnChange="updateRow(this.parentElement,'+i+')">',i),companyList.push(n[0]))}else appendPre("No results...")},function(e){appendPre("Error: "+e.result.error.message)})}function searchFunction(){var e,t,n,a;for(e=document.getElementById("search").value.toUpperCase(),t=document.getElementById("results_section").getElementsByTagName("tr"),a=0;a<t.length;a++)(n=t[a].getElementsByTagName("td")[0])&&(n.childNodes[1].value.toUpperCase().indexOf(e)>-1?t[a].style.display="":t[a].style.display="none")}function toggleMenu(){var e=document.getElementById("fixed_header_area");e.style.display="none"==e.style.display?"block":"none",randomGreeting()}function toggleAddForm(e){var t=document.getElementById(e);t.style.display="block"==t.style.display?"none":"block"}function onAddSubmit(e){e.preventDefault(),writeRow([document.getElementById("company").value,document.getElementById("domain").value,document.getElementById("email").value,document.getElementById("status").value,"=Now()"])}function writeRow(e){var t={values:[e]};gapi.client.sheets.spreadsheets.values.append({spreadsheetId:"15As92qSD9_6DEZC2nSdPtCqOSLFR4_KNiXWHC0JLY_E",range:"A1:E",valueInputOption:"USER_ENTERED",resource:t}).then(function(e){e.result;location.reload()})}function updateRow(e,t){e=[e.childNodes[1].value,e.childNodes[2].value,e.childNodes[3].value,e.childNodes[5].value,e.childNodes[0].value];var n="A"+(parseInt(t)+1)+":E"+(parseInt(t)+1),a={values:[e]};gapi.client.sheets.spreadsheets.values.update({spreadsheetId:"15As92qSD9_6DEZC2nSdPtCqOSLFR4_KNiXWHC0JLY_E",range:n,valueInputOption:"USER_ENTERED",resource:a}).then(function(e){e.result;listMajors()})}function sortTable(e,t){var n,a,s,l=["date","name","domain","email","skip","status"].indexOf(e);for(t=t.toUpperCase(),n=document.getElementById("results_section").getElementsByTagName("tr"),s=0;s<n.length;s++)(a=n[s].getElementsByTagName("td")[0])&&(a.childNodes[l].value.toUpperCase().indexOf(t)>-1?n[s].style.display="":n[s].style.display="none")}
